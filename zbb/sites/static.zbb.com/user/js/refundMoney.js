define("tools",[],function(require,exports,module){String.prototype.len=function(){return this.replace(/[^\x00-\xff]/g,"aa").length};var e=new RegExp("[^\0-ÿ]"),n=function(n,t,a){var o="clewTip"+a,i=document.getElementById(o),r=n.value.len();if(null==i){var s=n.parentNode,l=document.createElement("span");l.setAttribute("id",o),s.appendChild(l),i=document.getElementById(o)}if(r>t){for(var c=n.value.split(""),u=c.length,d=0,a=0,f=0;f<u&&!(d>=t);f++){if(e.test(c[f])){if(d+=2,d>=t)break}else d++;a++}n.value=n.value.substring(0,a),i.innerHTML="<b id='inFont' style='color:#D80000;'>"+n.value.len()+"</b>/"+t}else i.innerHTML="<b id='inFont' style='color:#139337;'>"+r+"</b>/"+t+"<span style='color:#999;padding-left:5px;font-size:12px;'>字符</span>"};module.exports=n}),define("refundMoney",["jquery","common/js/seajs/count_down","user/js/lightbox","tools"],function(require,exports,module){var $=require("jquery");require("common/js/seajs/count_down"),require("user/js/lightbox");var e=require("tools");exports.init=function(){function n(){var e=confirm("确认同意退款申请吗？"),n=$(this).data("rid");return!!e&&(!c&&(c=!0,void $.ajax({type:"POST",url:"/refund/drawback",dataType:"json",data:{rec_id:n},success:function(e){c=!1,e.success?window.location.href=e.data.url:alert(e.data)}})))}function t(){var e=$(this).data("rid"),n=$("#J-type").val(),t=$("#remark").val(),a=$("#uploadimg").val();return""==a?(alert("请上传图片凭证！"),!1):!c&&(c=!0,void $.ajax({type:"POST",url:"/refund/refused_money",dataType:"json",data:{rec_id:e,refuse_reason:n,supplement:t,uploadimg:a},success:function(e){e.success?(c=!1,alert(e.data),window.location.reload()):alert(e.data)}}))}function a(){$("#J_act_1").hide(),$("#J_act_2").show()}function o(){$("#J_act_2").hide(),$("#J_act_1").show()}$("#uploadimg").val(""),$(".goods-img").lightbox();var i=$("#J_agree"),r=$("#J_refuse"),s=$("#J_refused"),l=$("#J_cancel");$("#remark").on("keyup",function(){e(this,200,0)}),i.on("click",n);var c=!1;s.on("click",t),r.on("click",a),l.on("click",o)},exports.init()}),seajs.use("refundMoney");