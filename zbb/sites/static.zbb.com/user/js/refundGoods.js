define("tools",[],function(require,exports,module){String.prototype.len=function(){return this.replace(/[^\x00-\xff]/g,"aa").length};var e=new RegExp("[^\0-ÿ]"),n=function(n,t,o){var a="clewTip"+o,i=document.getElementById(a),r=n.value.len();if(null==i){var s=n.parentNode,l=document.createElement("span");l.setAttribute("id",a),s.appendChild(l),i=document.getElementById(a)}if(r>t){for(var c=n.value.split(""),u=c.length,d=0,o=0,f=0;f<u&&!(d>=t);f++){if(e.test(c[f])){if(d+=2,d>=t)break}else d++;o++}n.value=n.value.substring(0,o),i.innerHTML="<b id='inFont' style='color:#D80000;'>"+n.value.len()+"</b>/"+t}else i.innerHTML="<b id='inFont' style='color:#139337;'>"+r+"</b>/"+t+"<span style='color:#999;padding-left:5px;font-size:12px;'>字符</span>"};module.exports=n}),define("refundGoods",["jquery","common/js/seajs/count_down","user/js/lightbox","tools"],function(require,exports,module){var $=require("jquery");require("common/js/seajs/count_down"),require("user/js/lightbox");var e=require("tools");exports.init=function(){function n(){var e=confirm("确认同意退货申请吗？");if(e){var n=$(this).data("url");window.location.href=n}}function t(){var e=$(this).data("rid"),n=$("#J-type").val(),t=$("#remark").val(),o=$("#uploadimg").val();return""==o?(alert("请上传图片凭证！"),!1):!u&&(u=!0,void $.ajax({type:"POST",url:"/refund/refused_goods",dataType:"json",data:{rec_id:e,refuse_reason:n,supplement:t,uploadimg:o},success:function(e){u=!1,e.success?(alert(e.data),window.location.reload()):alert(e.data)}}))}function o(){$("#J_act_1").hide(),$("#J_act_2").show()}function a(){$("#J_act_2").hide(),$("#J_act_1").show()}function i(){var e=confirm("确认退款吗？"),n=$(this).data("rid");return!!e&&(!u&&(u=!0,void $.ajax({type:"POST",url:"/refund/drawback",dataType:"json",data:{rec_id:n},success:function(e){u=!1,e.success?window.location.href=e.data.url:alert(e.data)}})))}$("#uploadimg").val(""),$(".goods-img").lightbox();var r=$("#J_agree"),s=$("#J_refuse"),l=$("#J_refused"),c=$("#J_cancel");$("#remark").on("keyup",function(){e(this,200,0)}),r.on("click",n),l.on("click",t);var u=!1;s.on("click",o),c.on("click",a),$("#J_refuseMoney").on("click",i)},exports.init()}),seajs.use("refundGoods");