define("z_dialog",["jquery"],function(require,exports,module){var $=require("jquery"),e=function(e){$.extend(this,{content:null,width:null},e||{})};e.prototype={show:function(e){var e='<div id="J_make" class="g-remake"></div><div id="J_pop" class="g-pop"><span class="colse">X</span><div class="cont">'+this.content+"</div></div>";$("body").append(e),this.position()},remove:function(){$("#J_make,#J_pop").remove()},position:function(){$("#J_pop").css({width:this.width});var e=$("#J_pop").innerHeight()/2,t=$("#J_pop").innerWidth()/2;$("#J_pop").css({"margin-top":-e,"margin-left":-t})},init:function(){this.show(),$("body").on("click","#J_pop .colse",this.remove)}},module.exports=e}),define("ybglobal",["jquery"],function(require,exports,module){var $=require("jquery"),e=window.location.href.split(".")[1],t={};t.domain_www="http://www."+e+".com/",t.user_url="http://user."+e+".com/",t.help_url="http://help."+e+".com/",t.static_url="http://static."+e+".com/",t.img_url="http://img."+e+".com/",t.cookie=function(e,t,i){if("undefined"==typeof t){var n=null;if(document.cookie&&""!=document.cookie)for(var a=document.cookie.split(";"),o=0;o<a.length;o++){var s=$.trim(a[o]);if(s.substring(0,e.length+1)==e+"="){n=decodeURIComponent(s.substring(e.length+1));break}}return n}i=i||{},null===t&&(t="",i=$.extend({},i),i.expires=-1);var r="";if(i.expires&&("number"==typeof i.expires||i.expires.toUTCString)){var d;"number"==typeof i.expires?(d=new Date,d.setTime(d.getTime()+24*i.expires*60*60*1e3)):d=i.expires,r="; expires="+d.toUTCString()}var c=i.path?"; path="+i.path:"",l=i.domain?"; domain="+i.domain:"",p=i.secure?"; secure":"";document.cookie=[e,"=",encodeURIComponent(t),r,c,l,p].join("")},t.loadCSS=function(e){var t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)},t.isPhoen=function(e){var t=/^1[3|4|5|7|8][0-9]\d{8}$/;return t.test(e)},t.isCardID=function(e){var t=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;return t.test(e)},t.isTel=function(e){var t=/^([0|4\+]\d{2,3}[—]?-)?(0|8\d{2,3}-)?(\d{4,8})(-\d{1,4})?$/;return t.test(e)},t.isEmail=function(e){var t=/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;return t.test(e)},t.iszip=function(e){var t=/^\d{6}$/;return t.test(e)},t.cart=function(){var e=this.info()||"";""!=e&&$.ajax({url:t.cart_url+"/cart_count",type:"post",dataType:"jsonp",beforeSend:function(){$("#num_txt").html("0")},success:function(e){$("#num_txt").html(e.data)}})},t.message=function(){var e=this.info()||"";""!=e&&$.ajax({url:t.domain_www+"home/user_stat?"+(new Date).getTime(),type:"post",dataType:"jsonp",beforeSend:function(){$("#unread1").html()},success:function(e){$("#unread1").html(e.unread)}})},t.info=function(){var e=this.cookie("NZW_YZ");if(!e||2!=e.split("|").length)return null;var t=e.split("|");return{name:t[0],type:t[1]}},t.toTop=function(){var e=function(e,t,i){var n=$(e).click(function(){return $("body,html").animate({scrollTop:0},i),!1}),a=$(window),o=1140;a.width()>=o&&$(this).scroll(function(){$(this).scrollTop()>t?n.fadeIn(i):n.fadeOut(i)})};$('<a id="backToTop" title="回到顶部" target="_self" href="javascript:;"><i>回到顶部</i><span class="I-ico">&#xe713;</span></a>').appendTo("body"),e("#backToTop",500,300)},t.browserIE6_8=function(){var e=/msie 6/i.test(navigator.userAgent),t=/msie 7/i.test(navigator.userAgent),i=/msie 8/i.test(navigator.userAgent);/msie 9/i.test(navigator.userAgent);return!!(e||t||i)},t.cnzz=function(){var e=document.createElement("script");e.src="http://s11.cnzz.com/z_stat.php?id=1257124587&web_id=1257124587";var t=document.getElementsByTagName("body")[0];t.appendChild(e,t)},module.exports=t}),define("citySelect",["jquery"],function(require,exports,module){var $=require("jquery"),e=function(e){function t(){o=$(this).val(),s=$(this).find("option:selected").text();var e=$(this).attr("id");if(e==a.provice.substring(1))l.val(""),p.val(s);else if(e==a.city.substring(1))l.val(""),i=r.find("option:selected").text(),p.val(i+" "+s);else if(e==a.dist.substring(1))return l.val(o),i=r.find("option:selected").text(),n=d.find("option:selected").text(),p.val(i+" "+n+" "+s),!1;$.post(a.url,{parent_id:o},function(t){if(t.success){var i="<option value='0'>请选择……</option>";$.each(t.data,function(e){i+="<option value='"+t.data[e].region_id+"'>"+t.data[e].region_name+"</option>"}),e==a.provice.substring(1)&&(c.hide(),d.show().html(i)),e==a.city.substring(1)&&c.show().html(i)}},"json")}var i,n,a=$.extend({provice:"#provice",city:"#city",dist:"#dist",region_id:"#region_id",region_name:"#region_name",url:"/buyer/address/get_region"},e),o="",s="",r=$(a.provice),d=$(a.city),c=$(a.dist),l=$(a.region_id),p=$(a.region_name);r.on("change",t),d.on("change",t),c.on("change",t)};module.exports=e}),define("refund",["jquery","citySelect","z_dialog","ybglobal"],function(require,exports,module){var $=require("jquery"),e=require("citySelect"),t=require("z_dialog"),i=require("ybglobal");exports.init=function(){function n(){var e=confirm("确定删除该条退货地址吗？"),t=$(this);if(e){var i=$(this).data("id");$.ajax({type:"POST",url:"/address/addr_del",dataType:"json",data:{addr_id:i},success:function(e){e.success?(alert("已经成功删除该条退货地址！"),t.parents("tr").remove()):alert(e.data)}})}}function a(){$(this).hasClass("btn-def");var e=$(this).data("id"),t=$(this);$.ajax({type:"POST",url:"/address/set_default",dataType:"json",data:{addr_id:e},success:function(e){e.success?($(".J_def").removeClass("btn-def"),t.addClass("btn-def")):alert(e.data)}})}function o(){var e=$(this).data("c"),t=$(this).data("r"),i=$(this).data("addr"),n=$(this).data("zip"),a=$(this).data("m"),o=$(this).data("id"),s="/address/addr_edit",d="",c="",l="";$.ajax({type:"POST",url:"/address/addr_view",dataType:"json",data:{addr_id:o},success:function(p){if(p.success){$.each(p.data.region.country,function(e){d+=p.data.region.country[e].region_id==p.data.my_region.country?'<option value="'+p.data.region.country[e].region_id+'" selected="selected">'+p.data.region.country[e].region_name+"</option>":'<option value="'+p.data.region.country[e].region_id+'">'+p.data.region.country[e].region_name+"</option>"}),$.each(p.data.region.city,function(e){c+=p.data.region.city[e].region_id==p.data.my_region.city?'<option value="'+p.data.region.city[e].region_id+'" selected="selected">'+p.data.region.city[e].region_name+"</option>":'<option value="'+p.data.region.city[e].region_id+'">'+p.data.region.city[e].region_name+"</option>"}),$.each(p.data.region.province,function(e){l+=p.data.region.province[e].region_id==p.data.my_region.province?'<option value="'+p.data.region.province[e].region_id+'" selected="selected">'+p.data.region.province[e].region_name+"</option>":'<option value="'+p.data.region.province[e].region_id+'">'+p.data.region.province[e].region_name+"</option>"});var u='<div class="popBox"><div class="m-tt">修改退货地址</div><ul><li><span class="tt">* 收货人姓名：</span> <input id="J_name" type="text" class="txt" placeholder="请填写收货人姓名" value="'+e+'"/></li><li><span class="tt">* 所在地：</span><select class="select" name="" id="provice">'+l+'</select>　<select class="select" name="" id="city">'+c+'</select>　<select class="select" name="" id="country">'+d+'</select><input type="hidden" id="region_id" value="'+p.data.my_region.country+'"/><input type="hidden" id="region_name" value="'+t+'"/></li><li><span class="tt">* 详细地址：</span><textarea class="textarea" name="" id="J_addr" cols="30" rows="10">'+i+'</textarea></li><li><span class="tt">* 邮政编码：</span><input type="text" class="txt" id="J_zip" placeholder="请填写6位数字邮政编码" value="'+n+'"/></li><li><span class="tt">* 联系电话：</span><input type="text" id="J_phone" class="txt" placeholder="请填写您的联系电话" value="'+a+'"/></li></ul><div class="f-tac"><button class="btn" id="subBtn">保存收货地址</button></div></div>';r(u,s,o)}}})}function s(){var e='<option value=""> -- 请选择 -- </option>',t="/address/addr_add";$.ajax({type:"POST",url:"/address/get_province",dataType:"json",data:{parent_id:0},success:function(i){i.success&&$.each(i.data,function(t){e+='<option value="'+i.data[t].region_id+'">'+i.data[t].region_name+"</option>"});var n='<div class="popBox"><div class="m-tt">添加退货地址</div><ul><li><span class="tt">* 收货人姓名：</span> <input id="J_name" type="text" class="txt" placeholder="请填写收货人姓名"/></li><li><span class="tt">* 所在地：</span><select class="select" name="" id="provice">'+e+'</select>　<select class="select" name="" id="city" style="display:none"><option>地址</option></select>　<select class="select" name="" id="country"  style="display:none"><option>地址</option></select><input type="hidden" id="region_id"/><input type="hidden" id="region_name"/></li><li><span class="tt">* 详细地址：</span><textarea class="textarea" name="" id="J_addr" cols="30" rows="10"></textarea></li><li><span class="tt">* 邮政编码：</span><input type="text" id="J_zip" class="txt" placeholder="请填写6位数字邮政编码"/></li><li><span class="tt">* 联系电话：</span><input type="text" id="J_phone" class="txt" placeholder="请填写您的联系电话"/></li></ul><div class="f-tac"><button class="btn" id="subBtn">保存收货地址</button></div></div>';r(n,t)}})}function r(n,a,o){function s(){var e=$.trim($("#J_name").val()),t=$.trim($("#region_id").val()),n=$("#region_name").val(),s=$.trim($("#J_addr").val()),d=$.trim($("#J_zip").val()),c=$.trim($("#J_phone").val());if(""==e||""==t||""==s||""==d||""==c)return alert("请填写完相应信息！"),!1;if(!i.iszip(d))return alert("请填写正确的邮政编号！"),!1;if(!i.isPhoen(c))return alert("请填写正确的手机号！"),!1;if(o)var l={name:e,region_id:t,region_name:n,addr:s,zip:d,addr_id:o,phone:c};else var l={name:e,region_id:t,region_name:n,addr:s,zip:d,phone:c};$.ajax({type:"POST",url:a,dataType:"json",data:l,success:function(e){e.success?(r.remove(),alert(e.data),window.location.reload()):(r.remove(),alert(e.data))}})}var r=new t({content:n});r.init(),e({provice:"#provice",city:"#city",dist:"#country",region_id:"#region_id",region_name:"#region_name",url:"/address/get_province"}),$("body").off("click","#subBtn"),$("body").on("click","#subBtn",s)}$(".J_del").on("click",n),$(".J_def").on("click",a),$(".J_edit").on("click",o),$(".J_add").on("click",s)},exports.init()}),seajs.use("refund");